
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/01-parametric/parametric_static_mixer_1.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_01-parametric_parametric_static_mixer_1.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_01-parametric_parametric_static_mixer_1.py:


.. _ref_parametric_static_mixer_1:

Parametric Study Workflow
------------------------------
This example for executing a parametric study workflow
performs these steps:

- Reads a case file and data file
- Creates input and output parameters
- Instantiates a design point study
- Accesses and modifies the input parameters of
  the base design point (DP)
- Updates the current DP
- Accesses output parameters of the base DP
- Creates, updates, and deletes more DPs
- Creates, renames, and deletes parametric studies

.. GENERATED FROM PYTHON SOURCE LINES 22-23

Import the pyfluent module

.. GENERATED FROM PYTHON SOURCE LINES 23-25

.. code-block:: default

    import ansys.fluent.core as pyfluent








.. GENERATED FROM PYTHON SOURCE LINES 26-27

Import the path module

.. GENERATED FROM PYTHON SOURCE LINES 27-29

.. code-block:: default

    from pathlib import Path








.. GENERATED FROM PYTHON SOURCE LINES 30-31

Launch Fluent in 3D and double precision

.. GENERATED FROM PYTHON SOURCE LINES 31-34

.. code-block:: default


    session = pyfluent.launch_fluent(precision="double", processor_count=4)








.. GENERATED FROM PYTHON SOURCE LINES 35-36

Enable the settings API (Beta)

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: default


    root = session.get_settings_root()








.. GENERATED FROM PYTHON SOURCE LINES 40-41

Read the hopper/mixer case

.. GENERATED FROM PYTHON SOURCE LINES 41-50

.. code-block:: default


    from ansys.fluent.core import examples

    import_filename = examples.download_file(
        "Static_Mixer_main.cas.h5", "pyfluent/static_mixer"
    )

    session.tui.solver.file.read_case(case_file_name=import_filename)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2c2487160 state=running>



.. GENERATED FROM PYTHON SOURCE LINES 51-52

Set number of iterations to 1000 to ensure convergence

.. GENERATED FROM PYTHON SOURCE LINES 52-55

.. code-block:: default


    session.tui.solver.solve.set.number_of_iterations("1000")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2c292d850 state=running>



.. GENERATED FROM PYTHON SOURCE LINES 56-60

Create input parameters after enabling parameter creation in the TUI:
Parameter values:
Inlet1: velocity (inlet1_vel) 5 m/s and temperature (inlet1_temp) at 300 K
Inlet2: velocity (inlet2_vel) 10 m/s and temperature (inlet2_temp) at 350 K

.. GENERATED FROM PYTHON SOURCE LINES 60-77

.. code-block:: default


    session.tui.solver.define.parameters.enable_in_TUI("yes")

    session.tui.solver.define.boundary_conditions.set.velocity_inlet(
        "inlet1", (), "vmag", "yes", "inlet1_vel", 5, "quit"
    )
    session.tui.solver.define.boundary_conditions.set.velocity_inlet(
        "inlet1", (), "temperature", "yes", "inlet1_temp", 300, "quit"
    )

    session.tui.solver.define.boundary_conditions.set.velocity_inlet(
        "inlet2", (), "vmag", "yes", "no", "inlet2_vel", 10, "quit"
    )
    session.tui.solver.define.boundary_conditions.set.velocity_inlet(
        "inlet2", (), "temperature", "yes", "no", "inlet2_temp", 350, "quit"
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2c292da00 state=running>



.. GENERATED FROM PYTHON SOURCE LINES 78-79

Create output parameters using report definitions

.. GENERATED FROM PYTHON SOURCE LINES 79-110

.. code-block:: default


    root.solution.report_definitions.surface["outlet-temp-avg"] = {}
    root.solution.report_definitions.surface[
        "outlet-temp-avg"
    ].report_type = "surface-areaavg"
    root.solution.report_definitions.surface[
        "outlet-temp-avg"
    ].field = "temperature"
    root.solution.report_definitions.surface["outlet-temp-avg"].surface_names = [
        "outlet"
    ]

    root.solution.report_definitions.surface["outlet-vel-avg"] = {}
    root.solution.report_definitions.surface[
        "outlet-vel-avg"
    ].report_type = "surface-areaavg"
    root.solution.report_definitions.surface[
        "outlet-vel-avg"
    ].field = "velocity-magnitude"
    root.solution.report_definitions.surface["outlet-vel-avg"].surface_names = [
        "outlet"
    ]

    session.tui.solver.define.parameters.enable_in_TUI("yes")
    session.tui.solver.define.parameters.output_parameters.create(
        "report-definition", "outlet-temp-avg"
    )
    session.tui.solver.define.parameters.output_parameters.create(
        "report-definition", "outlet-vel-avg"
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2c2481b50 state=running>



.. GENERATED FROM PYTHON SOURCE LINES 111-112

Enable convergence condition check

.. GENERATED FROM PYTHON SOURCE LINES 112-115

.. code-block:: default


    session.tui.solver.solve.monitors.residual.criterion_type("0")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2dd570c70 state=running>



.. GENERATED FROM PYTHON SOURCE LINES 116-117

Write case with all the settings in place

.. GENERATED FROM PYTHON SOURCE LINES 117-122

.. code-block:: default

    case_path = str(
        Path(pyfluent.EXAMPLES_PATH) / "Static_Mixer_Parameters.cas.h5"
    )
    session.tui.solver.file.write_case(case_path)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2dd570910 state=running>



.. GENERATED FROM PYTHON SOURCE LINES 123-125

Parametric study workflow
Import the parametric study module

.. GENERATED FROM PYTHON SOURCE LINES 125-128

.. code-block:: default


    from ansys.fluent.parametric import ParametricStudy








.. GENERATED FROM PYTHON SOURCE LINES 129-130

Instantiate a parametric study from a Fluent session

.. GENERATED FROM PYTHON SOURCE LINES 130-133

.. code-block:: default


    study_1 = ParametricStudy(root.parametric_studies).initialize()








.. GENERATED FROM PYTHON SOURCE LINES 134-135

Access and modify input parameters of base DP

.. GENERATED FROM PYTHON SOURCE LINES 135-140

.. code-block:: default


    input_parameters_update = study_1.design_points["Base DP"].input_parameters
    input_parameters_update["inlet1_vel"] = 15
    study_1.design_points["Base DP"].input_parameters = input_parameters_update








.. GENERATED FROM PYTHON SOURCE LINES 141-142

Update current design point

.. GENERATED FROM PYTHON SOURCE LINES 142-145

.. code-block:: default


    study_1.update_current_design_point()








.. GENERATED FROM PYTHON SOURCE LINES 146-147

Change value of specific design points

.. GENERATED FROM PYTHON SOURCE LINES 147-155

.. code-block:: default


    design_point_1 = study_1.add_design_point()
    design_point_1_input_parameters = study_1.design_points["DP1"].input_parameters
    design_point_1_input_parameters["inlet1_temp"] = 450
    design_point_1_input_parameters["inlet1_vel"] = 30
    design_point_1_input_parameters["inlet2_vel"] = 20
    study_1.design_points["DP1"].input_parameters = design_point_1_input_parameters








.. GENERATED FROM PYTHON SOURCE LINES 156-157

Add another design point with different values of the input parameters

.. GENERATED FROM PYTHON SOURCE LINES 157-165

.. code-block:: default


    design_point_2 = study_1.add_design_point()
    design_point_2_input_parameters = study_1.design_points["DP2"].input_parameters
    design_point_2_input_parameters["inlet1_temp"] = 500
    design_point_2_input_parameters["inlet1_vel"] = 45
    design_point_2_input_parameters["inlet2_vel"] = 30
    study_1.design_points["DP2"].input_parameters = design_point_2_input_parameters








.. GENERATED FROM PYTHON SOURCE LINES 166-167

Duplicate design points

.. GENERATED FROM PYTHON SOURCE LINES 167-170

.. code-block:: default


    design_point_3 = study_1.duplicate_design_point(design_point_2)








.. GENERATED FROM PYTHON SOURCE LINES 171-172

Update all design points for study 1

.. GENERATED FROM PYTHON SOURCE LINES 172-175

.. code-block:: default


    study_1.update_all_design_points()








.. GENERATED FROM PYTHON SOURCE LINES 176-177

Export design point table as a CSV table

.. GENERATED FROM PYTHON SOURCE LINES 177-183

.. code-block:: default


    design_point_table = str(
        Path(pyfluent.EXAMPLES_PATH) / "design_point_table_study_1.csv"
    )
    study_1.export_design_table(design_point_table)








.. GENERATED FROM PYTHON SOURCE LINES 184-185

Display CSV table as a pandas dataframe

.. GENERATED FROM PYTHON SOURCE LINES 185-191

.. code-block:: default


    import pandas as pd

    data_frame = pd.read_csv(design_point_table)
    print(data_frame)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

           Name inlet1_temp  ...               Status Unnamed: 10
    0     Units         [K]  ...                  NaN         NaN
    1   Base DP         300  ...  Updated : Converged         NaN
    2       DP1         450  ...         Needs Update         NaN
    3       DP2         500  ...         Needs Update         NaN
    4       DP3         500  ...         Needs Update         NaN

    [5 rows x 11 columns]




.. GENERATED FROM PYTHON SOURCE LINES 192-193

Delete design points

.. GENERATED FROM PYTHON SOURCE LINES 193-196

.. code-block:: default


    study_1.delete_design_points([design_point_1, design_point_2])








.. GENERATED FROM PYTHON SOURCE LINES 197-198

Create a new parametric study by duplicating the current one

.. GENERATED FROM PYTHON SOURCE LINES 198-201

.. code-block:: default


    study_2 = study_1.duplicate()








.. GENERATED FROM PYTHON SOURCE LINES 202-204

Rename the newly created parametric study
Currently affected by issue # 249, hence commented out

.. GENERATED FROM PYTHON SOURCE LINES 204-207

.. code-block:: default


    # study_2.rename("New Study")








.. GENERATED FROM PYTHON SOURCE LINES 208-210

Delete the old parametric study
Currently affected by issue #249, hence commented out

.. GENERATED FROM PYTHON SOURCE LINES 210-213

.. code-block:: default


    # study_1.delete()








.. GENERATED FROM PYTHON SOURCE LINES 214-215

Save parametric project

.. GENERATED FROM PYTHON SOURCE LINES 215-221

.. code-block:: default


    project_filepath = str(
        Path(pyfluent.EXAMPLES_PATH) / "static_mixer_study.flprj"
    )

    session.tui.solver.file.parametric_project.save_as(project_filepath)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <Future at 0x7fd2cc59a130 state=running>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 3 minutes  14.751 seconds)


.. _sphx_glr_download_examples_01-parametric_parametric_static_mixer_1.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: parametric_static_mixer_1.py <parametric_static_mixer_1.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: parametric_static_mixer_1.ipynb <parametric_static_mixer_1.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
